<!DOCTYPE html>
<html>
<head>
<title>color-util benchmark</title>
<script src="../node_modules/lodash/lodash.js"></script>
<script src="../node_modules/platform/platform.js"></script>
<script src="../node_modules/benchmark/benchmark.js"></script>
<script src="../node_modules/chromatism/dist/chromatism.js"></script>
<script src="../dist/ColorUtil.min.js"></script>
</head>
<body>

<p>'npm run build' to create final ColorUtil package</p>
<p>Run with 'npm run watch' or launch html file without server</p>
<p>Open console to see progress and results</p>
<p>Copy csv output and place in csv file</p>

<script>
var colorUtilArgs = {
    rgb: {
        rgb: {r:255, g:255, b: 255},
        rgba: {r:255, g:255, b: 255, a: 255}
    },
    int: {
        int: 0xFFFFFF
    },
    hex: {
        hex: "#FFFFFF",
        shortHex: "#FFF"
    },
    rgbString: {
        rgbString: 'rgb(255,255,255)',
        rgbaString: 'rgba(255,255,255,0.5)',
        rgbaStringSpaces: 'rgba ( 255 , 255 , 255 , 0.5 )',
    },
    hsl: {
        hslWhite: {h:0,s:0,l:1},
        hslRed: {h:0,s:1,l:0.5},
        hslYellow: {h:1/6,s:1,l:0.5},
        hslGreen: {h:2/6,s:1,l:0.5}
    },
    hslString: {
        hsl: 'hsl(0,0%,100%)',
        hsla: 'hsla(0,0%,100%,1)',
        hslaWithSpaces: 'hsla( 0 , 0 % , 100 % , 1 )',
    },
    hsv: {
        hsvWhite: {h:0,s:0,l:1},
        hsvRed: {h:0,s:1,l:1},
        hsvYellow: {h:1/6,s:1,l:1},
        hsvGreen: {h:2/6,s:1,l:1}
    },
    any: {
        rgb: {r:255, g:255, b: 255},
        rgba: {r:255, g:255, b: 255, a: 255},
        int: 0xFFFFFF,
        hex: "#FFFFFF",
        shortHex: "#FFF",
        rgbString: 'rgba(255,255,255)',
        rgbaString: 'rgba(255,255,255,0.5)',
        hsl: {h:0,s:1,l:0.5},
        hsv: {h:0,s:1,l:1},
    }
}

var chromatismArgs =  {
    rgb: {r:255, g:255, b: 255},
    hex: '#FFFFFF',
    rgbString: 'rgb(255,255,255)',
    hsl: {h:0,s:1,l:0.5},
    hsv: {h:0,s:1,l:1}
};

var types = ['rgb', 'int', 'hex'];
var suite = new Benchmark.Suite;
let suite2 = new Benchmark.Suite;
var data = {};
var data2 = {};
var chromatismOptions = {library: 'chromatism'};
var colorUtilOptions = {library: 'color-util'};

// _.forEach(chromatismArgs, function(value, key) {
//     suite.add(`any(${key}) -> hex`, function() {
//         chromatism.convert(value).hex;
//     }, chromatismOptions);

//     suite.add(`any(${key}) -> rgb`, function() {
//         chromatism.convert(value).rgb;
//     }, chromatismOptions);

//     suite.add(`any(${key}) -> rgbString`, function() {
//         chromatism.convert(value).cssrgb;
//     }, chromatismOptions);

//     suite.add(`any(${key}) -> hsl`, function() {
//         chromatism.convert(value).hsl;
//     }, chromatismOptions);

//     suite.add(`any(${key}) -> hslString`, function() {
//         chromatism.convert(value).csshsl;
//     }, chromatismOptions);

//     suite.add(`any(${key}) -> hsv`, function() {
//         chromatism.convert(value).hsv;
//     }, chromatismOptions);
// });

// _.forEach(colorUtilArgs.any, (value, key) => {
//     suite.add(`any(${key}) -> hex`, function() {
//         ColorUtil.any.toHex(value);
//     }, colorUtilOptions);

//     suite.add(`any(${key}) -> rgb`, function() {
//         ColorUtil.any.toRgb(value);
//     }, colorUtilOptions);

//     suite.add(`any(${key}) -> rgbString`, function() {
//         ColorUtil.any.toRgbString(value);
//     }, colorUtilOptions);

//     suite.add(`any(${key}) -> hsl`, function() {
//         ColorUtil.any.toHsl(value);
//     }, colorUtilOptions);

//     // suite.add(`any(${key}) -> hslString`, function() {
//     //     ColorUtil.any.toHslString(value);
//     // }, colorUtilOptions);

//     suite.add(`any(${key}) -> hsv`, function() {
//         ColorUtil.any.toHsv(value);
//     }, colorUtilOptions);

//     suite.add(`any(${key}) -> int`, function() {
//         ColorUtil.any.toInt(value);
//     }, colorUtilOptions);
// });

iterateColorUtilConvertes((fromType, toType, toFnName, argName, arg) => {
    let fn = ColorUtil[fromType][toFnName];

    suite.add(`${argName} -> ${toType}`, function() {
        fn(arg);
    }, colorUtilOptions);
});

suite.on('cycle', function(event) {

    let key = event.target.name;

    if (!data[key]) {

        data[key] = {};
    }

    data[key][event.target.library] = Math.round(event.target.hz);

    console.log(event.target.library + ": " + event.target);
})

.on('complete', function() {
    console.log("-----");

    var csv = "operation,color-util,chromatism\n";

    _.forEach(data, function(item, key) {
        csv += key + "," + (item["color-util"]||"") + "," + (item.chromatism||"") + "\n"
    });

    console.log(csv);
})

.run({ 'async': true });








var gradient2 = ColorUtil.convert([0xFF0000,0x00FF00], ColorUtil.int.toRgb);
var gradient6 = ColorUtil.convert([0xFF0000,0xFFFF00,0x00FF00,0x00FFFF,0x0000FF,0xFF00FF], ColorUtil.int.toRgb);
var gradient12 = gradient6.concat(gradient6);
var gradient24 = gradient12.concat(gradient12);

var matrix2x2 = ColorUtil.convert([
    [0xFF0000,0x00FF00],
    [0x110000,0x001100]
], ColorUtil.int.toRgb);

var matrix2x6 = ColorUtil.convert([
    [0xFF0000,0xFFFF00,0x00FF00,0x00FFFF,0x0000FF,0xFF00FF],
    [0x110000,0x111100,0x001100,0x001111,0x000011,0x110011]
], ColorUtil.int.toRgb);

var matrix3x6 = ColorUtil.convert([
    [0xFF0000,0xFFFF00,0x00FF00,0x00FFFF,0x0000FF,0xFF00FF],
    [0x110000,0x111100,0x001100,0x001111,0x000011,0x110011],
    [0xEE0000,0xEEEE00,0x00EE00,0x00EEEE,0x0000EE,0xEE00EE]
], ColorUtil.int.toRgb);

var matrix4x6 = ColorUtil.convert([
    [0xFF0000,0xFFFF00,0x00FF00,0x00FFFF,0x0000FF,0xFF00FF],
    [0x110000,0x111100,0x001100,0x001111,0x000011,0x110011],
    [0xEE0000,0xEEEE00,0x00EE00,0x00EEEE,0x0000EE,0xEE00EE],
    [0x220000,0x222200,0x002200,0x002222,0x000022,0x220022]
], ColorUtil.int.toRgb);

var matrix12x12 = ColorUtil.convert([
    [0xFF0000,0xFFFF00,0x00FF00,0x00FFFF,0x0000FF,0xFF00FF,0xFF0000,0xFFFF00,0x00FF00,0x00FFFF,0x0000FF,0xFF00FF],
    [0x110000,0x111100,0x001100,0x001111,0x000011,0x110011,0x110000,0x111100,0x001100,0x001111,0x000011,0x110011],
    [0xEE0000,0xEEEE00,0x00EE00,0x00EEEE,0x0000EE,0xEE00EE,0xEE0000,0xEEEE00,0x00EE00,0x00EEEE,0x0000EE,0xEE00EE],
    [0x220000,0x222200,0x002200,0x002222,0x000022,0x220022,0x220000,0x222200,0x002200,0x002222,0x000022,0x220022],
    [0xFF0000,0xFFFF00,0x00FF00,0x00FFFF,0x0000FF,0xFF00FF,0xFF0000,0xFFFF00,0x00FF00,0x00FFFF,0x0000FF,0xFF00FF],
    [0x110000,0x111100,0x001100,0x001111,0x000011,0x110011,0x110000,0x111100,0x001100,0x001111,0x000011,0x110011],
    [0xEE0000,0xEEEE00,0x00EE00,0x00EEEE,0x0000EE,0xEE00EE,0xEE0000,0xEEEE00,0x00EE00,0x00EEEE,0x0000EE,0xEE00EE],
    [0x220000,0x222200,0x002200,0x002222,0x000022,0x220022,0x220000,0x222200,0x002200,0x002222,0x000022,0x220022],
    [0xFF0000,0xFFFF00,0x00FF00,0x00FFFF,0x0000FF,0xFF00FF,0xFF0000,0xFFFF00,0x00FF00,0x00FFFF,0x0000FF,0xFF00FF],
    [0x110000,0x111100,0x001100,0x001111,0x000011,0x110011,0x110000,0x111100,0x001100,0x001111,0x000011,0x110011],
    [0xEE0000,0xEEEE00,0x00EE00,0x00EEEE,0x0000EE,0xEE00EE,0xEE0000,0xEEEE00,0x00EE00,0x00EEEE,0x0000EE,0xEE00EE],
    [0x220000,0x222200,0x002200,0x002222,0x000022,0x220022,0x220000,0x222200,0x002200,0x002222,0x000022,0x220022]
], ColorUtil.int.toRgb);

suite2

.add(`getGradientColor 2 colors`, function() {
    ColorUtil.getGradientColor(gradient2, Math.random(), null, null);
})
.add(`getGradientColor 6 colors`, function() {
    ColorUtil.getGradientColor(gradient6, Math.random(), null, null);
})
.add(`getGradientColor 12 colors`, function() {
    ColorUtil.getGradientColor(gradient12, Math.random(), null, null);
})
.add(`getGradientColor 24 colors`, function() {
    ColorUtil.getGradientColor(gradient24, Math.random(), null, null);
})

.add(`getGradientMatrixColor 2x2 colors`, function() {
    ColorUtil.getGradientMatrixColor(matrix2x2, Math.random(), Math.random(), null, null);
})
.add(`getGradientMatrixColor 2x6 colors`, function() {
    ColorUtil.getGradientMatrixColor(matrix2x6, Math.random(), Math.random(), null, null);
})
.add(`getGradientMatrixColor 3x6 colors`, function() {
    ColorUtil.getGradientMatrixColor(matrix3x6, Math.random(), Math.random(), null, null);
})
.add(`getGradientMatrixColor 4x6 colors`, function() {
    ColorUtil.getGradientMatrixColor(matrix4x6, Math.random(), Math.random(), null, null);
})
.add(`getGradientMatrixColor 12x12 colors`, function() {
    ColorUtil.getGradientMatrixColor(matrix4x6, Math.random(), Math.random(), null, null);
})

.on('cycle', function(event) {

    let key = event.target.name;

    data2[key] = Math.round(event.target.hz);

    console.log(String(event.target));
})

.on('complete', function() {
    console.log("-----");

    var csv = "operation,ops\n";

    _.forEach(data2, function(ops, operation) {
        csv += operation + "," + ops + "\n";
    });

    console.log(csv);
})

// .run({ 'async': true });




function iterateColorUtilConvertes(itemCallback) {
    _.forEach(types, function(fromType) {
        var toFnNames = Object.getOwnPropertyNames(ColorUtil.prototype.constructor[fromType]);
        _.forEach(toFnNames, function(toFnName) {
            if (_.startsWith(toFnName, 'to')) {
                _.forEach(colorUtilArgs[fromType], function(arg, argName) {
                    let toType = _.lowerFirst(toFnName.substring(2))
                    itemCallback(fromType, toType, toFnName, argName, arg);
                });
            }
        });
    })
}

</script>
</body>

</html>